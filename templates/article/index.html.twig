{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} - Liste des articles{% endblock %}

{% block content %}
    <div class="container-fluid">
        <div class="row">
            {% block leftMenu %}
                {% if is_granted("ROLE_USER") %}
                    {{ render(controller('App\\Controller\\ArticleController::recentArticlesAction', {'nbArticles': 3 } )) }}
                {% endif %}
            {% endblock %}

            <div class="col-8 mt-3 mx-auto">
                <h1 class="text-dark my-3">
                    Liste des articles
                    {% if title is defined %}
                         - {{ title }}
                    {% endif %}
                </h1>
                <div class="row">
                    <div class="col-9">
                        {% for article in articles %}
                            <div class="jumbotron mb-3 bg-white border p-0">
                                <div class="row p-3">
                                    <div class="col-3 my-auto">
                                        <img src="{{ asset(article.image) }}"
                                            class="img-fluid rounded" alt="image en chargement ou corompue">
                                    </div>
                                    <div class="col-9">
                                        <h2>
                                            <a href="{{ path('article_show', { 'id': article.id }) }}"
                                            class="text-decoration-none text-primary font-weight-normal font-italic">
                                                {{ article.title|capitalize }}
                                            </a>
                                        </h2>
                                        <div class="details">
                                            <p class="font-weight-light font-italic text-muted mb-0">
                                                <small>Date de cr√©ation :
                                                    16/06/2020{#{{ article.createdAt|date('d:m:Y h:m:s') }}#}
                                                    {#{% if article.createdAt|date('d:m:Y h:m') < article.updatedAt|date('d:m:Y h:m') %}#}
                                                    {#{{ 'blog.updated_at'|trans }} : {{ article.updatedAt|date('d:m:Y h:m:s') }}#}
                                                    {#{% endif %}#}
                                                </small>
                                            </p>
                                        </div>
                                        <div>
                                            {#{% for category in article.categories  %}#}
                                            <a class="badge badge-info"
                                            href="{{ path('article_index') }}{# {{ path('category_article_index', {'id': category.id}) }} #}">
                                                {{ article.theme.name }}
                                            </a>
                                            {#{% endfor %}#}
                                            <span class="ml-2">
                                    {{ article.nbViews }} <i class="far fa-eye fa-sm"></i> |
                                    {#{{ article.comments|length }}#} 0 <i class="far fa-comments"></i>
                                </span>
                                        </div>
                                        <span class="text-muted">{{ article.content|slice(0, sliceLength) ~ '...' }}</span>
                                        <a class="text-decoration-none move-arrow"
                                        href="{{ path('article_show', {'id': article.id}) }}" role="button">
                                            Voir plus <i class="fas fa-arrow-right fa-sm"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="col-3 pl-0">
                        <div class="card">
                            <div class="card-body p-3">
                                <h5 class="card-title">Recherche</h5>
                                <form class="form-inline">
                                    <input class="form-control mr-sm-2 w-75" type="search" placeholder="Rechercher..." aria-label="Rechercher">
                                    <button class="btn btn-outline-primary my-2 my-sm-0" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mx-auto">
            {% if id is defined %}
                {{ include('_pagination.html.twig', {'currentPath': currentPath, 'page': page, 'nbPage': nbPage, 'id': id}) }}
            {% else %}
                {{ include('_pagination.html.twig', {'currentPath': currentPath, 'page': page, 'nbPage': nbPage}) }}
            {% endif %}
        </div>
    </div>
{% endblock %}
